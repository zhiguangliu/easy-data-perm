# 通用数据权限组件
## 概述

数据权限与功能权限相比，复杂性更高。

按控制对象划分，可以分为行权限和列权限两类，行权限是只用户可以看到某一行的数据，列权限是指这些行中，用户可以看到哪些列的数据。

按控制的操作类型划分，可以分为查询操作权限，插入操作权限、修改操作权限。

目前我们仅实现了对查询操作的行权限控制，其他控制暂未实现。

我们可以实现与业务系统松耦合的情况下，对业务代码无侵入的权限控制。

## 场景描述

嬴总开了一家公司，产品行销全国，需要分区域管理。公司的销售部由嬴总直接担任总监，下面设置了三个销售经理刘大（负责东北）、关二（负责华北）、张三（负责西北）。每个人手下都有若干销售，每个省至少有一名销售负责，对于一些大省由多名销售共同负责。

之前为了便于客户管理，公司开发了crm系统，但是当时业务没有这么大，crm没有做数据权限方面的设计。所有人都可以看到所有的客户数据。现在需要增加数据权限控制，让嬴总可以看到所有客户数据，销售经理可以看到自己负责区域的客户数据，负责全省的销售可以看全省数据，多个销售负责一个省的，每个销售只能看到自己负责的那部分数据。

## 需求分析

1. 客户信息有所属省份和维系人这两个字段可以用来做权限控制
2. 对于嬴总，数据权限是“不控制”
3. 对于销售经理，数据权限是 所属省份 in (A省,B省,C省)
4. 对于负责全省的销售，数据权限是 所属省份=A省
5. 对于负责一个省的部分客户的销售，数据权限是 所属省份=A省 and 维系人=销售员id

## 测试数据

用户数据：

| 用户id | 用户名 | 职务     | 负责区域                 |
| ------ | ------ | -------- | ------------------------ |
| 1      | 嬴总   | 销售总监 | 所有                     |
| 2      | 刘大   | 销售经理 | 负责东北（黑吉辽）       |
| 3      | 关二   | 销售经理 | 负责华北（京津冀蒙晋鲁） |
| 4      | 张三   | 销售经理 | 负责西北（陕甘青宁新）   |
| 5      | 李四   | 销售员   | 北京城区                 |
| 6      | 朱五   | 销售员   | 北京郊区                 |
| 7      | 杨六   | 销售员   | 天津                     |
| 8      | 牛七   | 销售员   | 河北                     |
| 9      | 马八   | 销售员   | 内蒙                     |
| 10     | 侯九   | 销售员   | 山西                     |

客户数据：

| 客户id | 客户名称           | 所属省份 | 创建人id | 维系人id |
| ------ | ------------------ | -------- | -------- | -------- |
| 1      | 北京雾灵山有限公司 | 京       | 1        | 6        |
| 2      | 北京慕田峪有限公司 | 京       | 1        | 6        |
| 3      | 北京景山有限公司   | 京       | 1        | 5        |
| 4      | 天津盘山有限公司   | 津       | 1        | 7        |
| 5      | 河北燕山有限公司   | 冀       | 1        | 8        |
| 6      | 河北狼牙山有限公司 | 冀       | 1        | 8        |
| 7      | 内蒙贺兰山有限公司 | 蒙       | 1        | 9        |
| 8      | 内蒙阴山有限公司   | 蒙       | 1        | 9        |
| 9      | 山西五台山有限公司 | 晋       | 1        | 10       |
| 10     | 山西恒山有限公司   | 晋       | 1        | 10       |

### 以华北地区为例，描述一下数据权限的具体需求

嬴总：没有附加条件

关二：所属省份 in ('京','津','冀','蒙','晋','鲁')    其实是  省份=‘京’ or 省份=‘津’ or 省份=‘冀’ or 省份=‘蒙’ or 省份=‘晋’ or 省份=‘鲁’

李四：所属省份 = ‘京’ and 维系人id=5          景山在城里

朱五：所属省份 = ‘京’ and 维系人id=6

杨六：所属省份 = ‘津’

牛七、马八、侯九与杨六同理
